<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Drinkassistent üç∏</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#2b2b2b" />
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>

  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #fafafa;
      color: #222;
      margin: 0;
      padding: 1rem;
    }
    h1 { text-align: center; }
    .category { margin-top: 1rem; }
    label { display: block; cursor: pointer; }
    .drink {
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 10px;
      margin: 10px 0;
      background: #fff;
    }
    .possible { background: #c8f7c5; }
    .almost { background: #fff5c4; }
    .missing { background: #f0f0f0; }
    .details {
      margin-top: 0.5rem;
      font-size: 0.9rem;
      display: none;
    }
    .drink.open .details {
      display: block;
    }
    .drink strong {
      cursor: pointer;
      display: inline-block;
      width: 100%;
    }
  </style>
</head>
<body>
  <h1>üçπ Drinkassistent</h1>
  <p>Markera vad du har hemma ‚Äì se vilka drinkar du kan (eller n√§stan kan) g√∂ra!</p>

  <div id="ingredients"></div>
  <h2>Dina m√∂jliga drinkar</h2>
  <div id="results"></div>

  <script>
    const categories = {
      "Alkohol": ["Vodka", "Gin", "Rom", "Whisky", "Tequila", "Cointreau"],
      "Juice / Frukt": ["Limejuice", "Citronjuice", "Apelsinjuice", "Ananasjuice"],
      "S√∂tning": ["Sockerlag", "Grenadin"],
      "√ñvrigt": ["Mynta", "Sodavatten", "Tonic"]
    };

    const drinks = [
      { 
        name: "Margarita", 
        ingredients: ["Tequila", "Cointreau", "Limejuice"], 
        recipe: [
          { item: "Tequila", amount: "4 cl" },
          { item: "Cointreau", amount: "2 cl" },
          { item: "Limejuice", amount: "2 cl" }
        ],
        steps: "Skaka alla ingredienser med is och sila upp i kyld cocktailglas. Garnera med limeklyfta."
      },
      { 
        name: "Mojito", 
        ingredients: ["Rom", "Limejuice", "Mynta", "Sodavatten", "Sockerlag"], 
        recipe: [
          { item: "Rom", amount: "5 cl" },
          { item: "Limejuice", amount: "3 cl" },
          { item: "Sockerlag", amount: "2 cl" },
          { item: "Mynta", amount: "8 blad" },
          { item: "Sodavatten", amount: "Toppa upp" }
        ],
        steps: "Muddla mynta, sockerlag och limejuice i glaset. Fyll p√• med rom och sodavatten. R√∂r om f√∂rsiktigt."
      },
      { 
        name: "Whisky Sour", 
        ingredients: ["Whisky", "Citronjuice", "Sockerlag"], 
        recipe: [
          { item: "Whisky", amount: "5 cl" },
          { item: "Citronjuice", amount: "3 cl" },
          { item: "Sockerlag", amount: "2 cl" }
        ],
        steps: "Skaka alla ingredienser med is och sila upp i glas med is. Garnera med citronskiva."
      },
      { 
        name: "Vodka Tonic", 
        ingredients: ["Vodka", "Tonic"], 
        recipe: [
          { item: "Vodka", amount: "5 cl" },
          { item: "Tonic", amount: "Toppa upp" }
        ],
        steps: "Fyll glas med is, h√§ll i vodka och toppa med tonic. R√∂r om l√§tt."
      },
      { 
        name: "Tequila Sunrise", 
        ingredients: ["Tequila", "Apelsinjuice", "Grenadin"], 
        recipe: [
          { item: "Tequila", amount: "4 cl" },
          { item: "Apelsinjuice", amount: "10 cl" },
          { item: "Grenadin", amount: "1 cl" }
        ],
        steps: "H√§ll tequila och apelsinjuice i glas med is. Tills√§tt grenadin f√∂rsiktigt s√• den sjunker till botten."
      },
      { 
        name: "Gin Fizz", 
        ingredients: ["Gin", "Citronjuice", "Sockerlag", "Sodavatten"], 
        recipe: [
          { item: "Gin", amount: "4 cl" },
          { item: "Citronjuice", amount: "3 cl" },
          { item: "Sockerlag", amount: "2 cl" },
          { item: "Sodavatten", amount: "Toppa upp" }
        ],
        steps: "Skaka gin, citronjuice och sockerlag med is. Sila i glas och toppa med sodavatten."
      }
    ];

    const ingredientsDiv = document.getElementById('ingredients');
    const resultsDiv = document.getElementById('results');

    // skapa checkboxar
    for (const [cat, items] of Object.entries(categories)) {
      const div = document.createElement('div');
      div.className = 'category';
      div.innerHTML = `<h3>${cat}</h3>`;
      items.forEach(i => {
        const id = i.replace(/\s/g, '_');
        div.innerHTML += `<label><input type="checkbox" value="${i}" id="${id}"> ${i}</label>`;
      });
      ingredientsDiv.appendChild(div);
    }

    document.querySelectorAll('input[type=checkbox]').forEach(cb => {
      cb.addEventListener('change', updateResults);
    });

    function updateResults() {
      const selected = Array.from(document.querySelectorAll('input:checked')).map(cb => cb.value);
      resultsDiv.innerHTML = '';

      // sortera s√• att de man kan g√∂ra hamnar √∂verst
      const sortedDrinks = [...drinks].sort((a, b) => {
        const missA = a.ingredients.filter(i => !selected.includes(i)).length;
        const missB = b.ingredients.filter(i => !selected.includes(i)).length;
        return missA - missB;
      });

      sortedDrinks.forEach(drink => {
        const missing = drink.ingredients.filter(i => !selected.includes(i));
        const div = document.createElement('div');
        div.classList.add('drink');

        if (missing.length === 0) div.classList.add('possible');
        else if (missing.length <= 2) div.classList.add('almost');
        else div.classList.add('missing');

        div.innerHTML = `<strong>${drink.name}</strong>`;
        
        const details = document.createElement('div');
        details.className = 'details';
        details.innerHTML = `
          <h4>Recept:</h4>
          <ul>${drink.recipe.map(r => `<li>${r.amount} ${r.item}</li>`).join('')}</ul>
          <p><em>${drink.steps}</em></p>
        `;
        div.appendChild(details);

        div.querySelector('strong').addEventListener('click', () => {
          div.classList.toggle('open');
        });

        resultsDiv.appendChild(div);
      });
    }
  </script>
</body>
</html>
